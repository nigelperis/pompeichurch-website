---
import Layout from "~/layouts/layout.astro";
import { getLangFromUrl, useTranslations } from "~/i18n/utils";
import { Locale } from "~/enums/locale";
import { cn } from "~/helpers/cn";
import ChevronDown from '~/assets/icons/chevron-down.svg?react';
import CheckMark from '~/assets/icons/check-mark.svg';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const wards = [
  "Addoor",
  "Church",
  "Gurpur",
  "Pompei A",
  "Pompei B",
  "Kandar A",
  "Kandar B",
  "Kowdoor A",
  "Kowdoor B",
  "Monel",
]
---

<Layout title="Parishioners Achievements Form">
  <main class="mx-auto max-w-4xl overflow-hidden bg-white">
    <section id="parishioner-achievements" class="flex flex-col p-6 pb-4">
      <h1
        class={cn(
          "font-roboto font-black border-natgeo-yellow mb-4 border-l-4 pl-3 text-3xl lg:text-4xl",
          {
            "font-noto-sans-kannada font-bold": lang === Locale.KOK,
          },
        )}
      >
        {t("nav.parishioners-achievements")}
      </h1>

      <div class="">
        Criteria
      </div>

      <div class="w-full h-0.5 mx-auto my-4 bg-natgeo-yellow rounded-md "></div>

      <form class="flex-1 space-y-6" enctype="multipart/form-data" id="achievementsForm">
        <!-- Full Name of the achiever or Team Name -->
        <div>
          <label for="full-name" class="text-sm font-light leading-6 text-gray-700">Full Name / Team Name <span class="text-red-500">*</span></label>
          <input id="full-name" type="text" name="full-name" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" required placeholder="E.g. John Doe / Team Aurora"></input>
        </div>

        <!-- Achievement -->
        <div>
          <label for="achievement" class="text-sm font-light leading-6 text-gray-700">Achievement <span class="text-red-500">*</span></label>
          <input id="achievement" type="text" name="achievement" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" required placeholder="E.g. Best Speaker at National Conference"></input>
        </div>

        <!-- Achiever Image -->
        <div>
          <label for="achiever-image" class="text-sm font-light leading-6 text-gray-700">Achiever Image <span class="text-red-500">*</span></label>
          <input id="achiever-image" type="file" name="achiever-image" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" accept=".jpg, .jpeg, .png, image/jpeg, image/png"></input>
          <p id="achiever-image-error" class="text-xs text-red-500 mt-1"></p>
        </div>

        <!-- Issue Date -->
        <div>
          <label for="issue-date" class="text-sm font-light leading-6 text-gray-700">Issue Date <span class="text-red-500">*</span></label>
          <input id="issue-date" type="date" name="issue-date" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" required></input>
        </div>

        <!-- Parents or Team Members Names -->
        <div>
          <label for="parents-name" class="text-sm font-light leading-6 text-gray-700">Parents / Team Members Names <span class="text-red-500">*</span></label>
          <input id="parents-name" type="text" name="parents-name" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" required placeholder="E.g. John Doe and Jane Doe / John, Sam, Jane"></input>
        </div>

        <!-- Ward (optional for teams) -->
        <div>
          <div id="ward-select" class="relative w-full mx-auto">
            <label for="ward-input" class="block text-sm font-light text-gray-700 mb-1">
              Ward
            </label>

            <input id="ward-input" type="text" name="ward-input" class="block w-full border border-gray-300 p-3 pr-10 focus:outline-gray-200 placeholder-gray-600 cursor-pointer" placeholder="Select your ward..." readonly></input>

            <ChevronDown id="dropdown-chevron" className="absolute w-6 h-6 right-3 top-1/2 text-gray-600 cursor-pointer" />

            <!-- Ward names Dropdown -->
            <div id="ward-options-menu" class="absolute left-0 right-0 mt-1 bg-white border border-gray-300 rounded-b-md z-10 max-h-36 overflow-y-auto hidden">
              {wards.map((ward) => (
                <div class="p-2 cursor-pointer hover:bg-blue-100">
                  {ward}
                </div>
              ))}
            </div>
          </div>
        </div>

        <!-- Submitted By -->
        <div>
          <label for="submitted-by" class="text-sm font-light leading-6 text-gray-700">Submitted By <span class="text-red-500">*</span></label>
          <input id="submitted-by" type="text" name="submitted-by" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" required placeholder="E.g. John Doe"></input>
        </div>

        <!-- Proof of Achievement -->
        <div>
          <label for="proof-of-achievement" class="text-sm font-light leading-6 text-gray-700">Proof of Achievement <span class="text-red-500">*</span></label>
          <input id="proof-of-achievement" type="file" name="proof-of-achievement" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" accept=".jpg, .jpeg, .png, image/jpeg, image/png"></input>
          <p id="proof-of-achievement-error-message" class="text-xs text-red-500 mt-1"></p>
        </div>

        <!-- Additional Photos (only 2 if any) -->
        <div>
          <label for="additional-images" class="text-sm font-light leading-6 text-gray-700">Additional Photos(only 2 if any)</label>
          <input id="additional-images" type="file" name="additional-images" class="block w-full border border-gray-300 p-3 focus:outline-gray-300 placeholder-gray-600" multiple accept=".jpg, .jpeg, .png, image/jpeg, image/png"></input>
          <p id="additional-images-error" class="text-xs text-red-500 mt-1"></p>
        </div>

        <!-- Submit Button -->
        <div class="flex items-center justify-center mt-4 mb-0">
          <button type="submit" class="bg-natgeo-yellow text-black text-semibold px-4 py-2 rounded-md">Submit</button>
        </div>

        <!-- Honeypot Spam Trap (hidden) -->
        <div class="hidden">
          <label for="honeypot">Important</label>
          <input type="text" name="honeypot" id="honeypot" tabindex="-1" autocomplete="off" />
        </div>

        <!-- Success Toast -->
        <div id="toast"class="fixed top-6 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-4 text-lg font-bold z-50 rounded-xl shadow-lg opacity-0 transition-opacity duration-300 pointer-events-none flex items-center gap-3">
          <CheckMark class="w-6 h-6" />
          <span id="toast-text">Submission successful</span>
        </div>
      </form>
    </section>
  </main>
  <script>
    import { achievementForm } from "~/scripts/achievement-form";
    achievementForm();
  </script>
</Layout>