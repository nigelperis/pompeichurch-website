---
import { Icon } from 'astro-icon/components';
interface Subtitle {
  commission: string;
  name: string;
}

interface Props {
  convenor: string;
  title: string;
  subtitles?: Subtitle[];
}

const { convenor, title, subtitles } = Astro.props;
const uniqueId = Math.random().toString(36).substring(2, 9);
---

<div class="border border-yellow-300 shadow-sm rounded-md w-full max-w-3xl mx-auto my-10">
  <div class="flex justify-between items-center p-4 rounded-md bg-yellow-100 cursor-pointer dropdown-toggle" data-dropdown-id={uniqueId}>
    <h3 class="font-extrabold text-xl">{title}</h3>
    <Icon
      name="chevron-right"
      class="arrow transform transition-transform w-6 h-6 text-yellow-600"
      data-icon-name="chevron-right"
    />
  </div>

  <div class="dropdown-content overflow-hidden text-left pl-4 pr-4" data-dropdown-id={uniqueId}>
    <div class="mt-2">
      <p class="text-xl text-gray-700"><strong>Convenor:</strong> <span class="text-gray-500 text-xl">{convenor}</span></p>
    </div>
    <table class="table-auto w-full mt-4 mb-4">
      <thead>
        <tr>
          <th class="text-left text-xl font-bold border-b-2 pb-2 text-yellow-500">Commission</th>
          <th class="text-left text-xl font-bold border-b-2 pb-2 text-yellow-500">Secretary</th>
        </tr>
      </thead>
      <tbody>
        {subtitles?.map((subtitle) => (
          <tr key={subtitle.commission}>
            <td class="py-2 text-sm"><strong>{subtitle.commission}</strong></td>
            <td class="py-2 text-sm text-gray-600">{subtitle.name}</td>
          </tr>
        ))}
      </tbody>
    </table>
  </div>
</div>

<style>
  .dropdown-content {
    max-height: 0;
    opacity: 0;
    transition: max-height 0.4s ease-in-out, opacity 0.4s ease-in-out;
    overflow: hidden;
  }
  .dropdown-content.open {
    max-height: 1000px;
    opacity: 1;
  }
  .arrow {
    transition: transform 0.3s ease;
    transform: rotate(90deg);
  }
  .arrow.rotate {
    transform: rotate(-90deg);
  }
  @media (max-width: 768px) {
    .text-lg {
      font-size: 0.875rem;
    }
  }
</style>


<script>
  document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
    toggle.addEventListener('click', function() {
      const dropdownId = this.getAttribute('data-dropdown-id');
      const dropdownContent = document.querySelector(`.dropdown-content[data-dropdown-id="${dropdownId}"]`);
      const arrow = this.querySelector('.arrow');
      const isOpen = dropdownContent.classList.contains('open');

      if (isOpen) {
        dropdownContent.style.maxHeight = dropdownContent.scrollHeight + 'px';
        dropdownContent.offsetHeight;
        dropdownContent.style.maxHeight = '0';
        dropdownContent.classList.remove('open');
        arrow.classList.remove('rotate');
      } else {
        dropdownContent.style.maxHeight = dropdownContent.scrollHeight + 'px';
        dropdownContent.classList.add('open');
        arrow.classList.add('rotate');
      }
    });
  });
</script>

